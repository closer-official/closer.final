<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CLOSER | MEMBERSHIP LOGIN</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Noto+Serif+JP:wght@300;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Tailwindの設定でカスタムカラーとフォントを定義
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        gold: '#C5A059',
                        dark: '#111111',
                    },
                    fontFamily: {
                        cinzel: ['Cinzel', 'serif'],
                        noto: ['Noto Serif JP', 'serif'],
                    },
                }
            }
        }
    </script>
    <style>
        /* カスタムスタイル */
        body {
            background-color: #000;
            color: #fff;
            font-family: 'Noto Serif JP', serif;
        }
        .login-container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 2rem;
            text-align: center;
        }
        .login-button {
            background-color: #C5A059;
            color: #000;
            font-family: 'Cinzel', serif;
            font-weight: 700;
            padding: 1rem 2rem;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s;
            width: 100%;
            max-width: 320px;
            letter-spacing: 0.1em;
        }
        .login-button:hover {
            background-color: #b38f4d;
        }
    </style>
</head>
<body class="bg-black">

    <div class="login-container">
        <header class="flex justify-between items-center p-6">
            <div class="text-3xl font-cinzel text-gold tracking-widest">CLOSER</div>
            <button class="border border-gold text-gold font-cinzel px-4 py-2 text-sm tracking-wider hover:bg-gold hover:text-black transition">BLACK</button>
        </header>

        <main class="main-content">
            <h1 class="text-2xl md:text-3xl font-cinzel text-gold mb-8 tracking-widest">MEMBERSHIP LOGIN</h1>
            <p class="text-gray-300 mb-4 leading-relaxed font-noto">
                CLOSERは完全招待制のクローズド・コミュニティです。<br>
                信頼されたGoogleアカウントで認証してください。
            </p>
            <button id="google-login-btn" class="login-button mt-8">
                ENTER WITH GOOGLE
            </button>
        </main>

        <footer class="p-6 text-center text-gray-500 text-sm font-cinzel">
            © 2025 CLOSER Project.
        </footer>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAmPN0z032Uo_ONsronn3smkIixRnBReJw",
            authDomain: "closer-official.firebaseapp.com",
            projectId: "closer-official",
            storageBucket: "closer-official.firebasestorage.app",
            messagingSenderId: "1039215613610",
            appId: "1:1039215613610:web:540ef7a026714e28dbe2d3",
            measurementId: "G-LYK0THB2Z2"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const provider = new GoogleAuthProvider();

        // 1. ログイン状態の監視（すでにログイン済みならタイムラインへ）
        onAuthStateChanged(auth, (user) => {
            if (user) {
                console.log("Already logged in. Redirecting to timeline.");
                window.location.href = "timeline.html";
            }
        });

        // 2. Googleログインボタンのクリック処理
        const loginButton = document.getElementById('google-login-btn');
        loginButton.addEventListener('click', async () => {
            try {
                await signInWithPopup(auth, provider);
                console.log("Login successful!");
                // onAuthStateChangedが検知してリダイレクトします
            } catch (error) {
                console.error("Login failed:", error);
                alert("ログインに失敗しました。");
            }
        });
    </script>
</body>
</html>